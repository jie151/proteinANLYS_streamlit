<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Container for multiple Chromatogram objects</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for MChromatograms {MSnbase}"><tr><td>MChromatograms {MSnbase}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Container for multiple Chromatogram objects</h2>

<h3>Description</h3>

<p>The <code>MChromatograms</code> class allows to store
<code><a href="../../MSnbase/help/Chromatogram.html">Chromatogram()</a></code> objects in a <code>matrix</code>-like
two-dimensional structure.
</p>


<h3>Usage</h3>

<pre>
MChromatograms(data, phenoData, featureData, ...)

## S4 method for signature 'MChromatograms'
show(object)

## S4 method for signature 'MChromatograms,ANY,ANY,ANY'
x[i, j, drop = FALSE]

## S4 replacement method for signature 'MChromatograms'
x[i, j] &lt;- value

## S4 method for signature 'MChromatograms,ANY'
plot(
  x,
  col = "#00000060",
  lty = 1,
  type = "l",
  xlab = "retention time",
  ylab = "intensity",
  main = NULL,
  ...
)

## S4 method for signature 'MChromatograms'
phenoData(object)

## S4 method for signature 'MChromatograms'
pData(object)

## S4 replacement method for signature 'MChromatograms,data.frame'
pData(object) &lt;- value

## S4 method for signature 'MChromatograms'
x$name

## S4 replacement method for signature 'MChromatograms'
x$name &lt;- value

## S4 replacement method for signature 'MChromatograms'
colnames(x) &lt;- value

## S4 method for signature 'MChromatograms'
sampleNames(object)

## S4 replacement method for signature 'MChromatograms,ANY'
sampleNames(object) &lt;- value

## S4 method for signature 'MChromatograms'
isEmpty(x)

## S4 method for signature 'MChromatograms'
featureNames(object)

## S4 replacement method for signature 'MChromatograms'
featureNames(object) &lt;- value

## S4 method for signature 'MChromatograms'
featureData(object)

## S4 replacement method for signature 'MChromatograms,ANY'
featureData(object) &lt;- value

## S4 method for signature 'MChromatograms'
fData(object)

## S4 replacement method for signature 'MChromatograms,ANY'
fData(object) &lt;- value

## S4 method for signature 'MChromatograms'
fvarLabels(object)

## S4 replacement method for signature 'MChromatograms'
rownames(x) &lt;- value

## S4 method for signature 'MChromatograms'
precursorMz(object)

## S4 method for signature 'MChromatograms'
productMz(object)

## S4 method for signature 'MChromatograms'
mz(object)

## S4 method for signature 'MChromatograms'
polarity(object)

## S4 method for signature 'MChromatograms'
bin(x, binSize = 0.5, breaks = numeric(), fun = max)

## S4 method for signature 'MChromatograms'
clean(object, all = FALSE, na.rm = FALSE)

## S4 method for signature 'MChromatograms'
normalize(object, method = c("max", "sum"))

## S4 method for signature 'MChromatograms'
filterIntensity(object, intensity = 0, ...)

## S4 method for signature 'MChromatograms,Chromatogram'
alignRt(x, y, method = c("closest", "approx"), ...)

## S4 method for signature 'MChromatograms'
c(x, ...)

## S4 method for signature 'MChromatograms,missing'
compareChromatograms(
  x,
  y,
  ALIGNFUN = alignRt,
  ALIGNFUNARGS = list(),
  FUN = cor,
  FUNARGS = list(use = "pairwise.complete.obs"),
  ...
)

## S4 method for signature 'MChromatograms,MChromatograms'
compareChromatograms(
  x,
  y,
  ALIGNFUN = alignRt,
  ALIGNFUNARGS = list(),
  FUN = cor,
  FUNARGS = list(use = "pairwise.complete.obs"),
  ...
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
<p>for <code>MChromatograms</code>: a <code>list</code> of <code><a href="../../MSnbase/help/Chromatogram.html">Chromatogram()</a></code> objects.</p>
</td></tr>
<tr valign="top"><td><code>phenoData</code></td>
<td>
<p>for <code>MChromatograms</code>: either a <code>data.frame</code>,
<code>AnnotatedDataFrame</code> describing the phenotypical information of the
samples.</p>
</td></tr>
<tr valign="top"><td><code>featureData</code></td>
<td>
<p>for <code>MChromatograms</code>: either a <code>data.frame</code> or
<code>AnnotatedDataFrame</code> with additional information for each row of
chromatograms.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>for <code>MChromatograms</code>: additional parameters to be passed to the
<code>matrix</code> constructor, such as <code>nrow</code>, <code>ncol</code> and <code>byrow</code>.
For <code>compareChromatograms</code>: ignored.</p>
</td></tr>
<tr valign="top"><td><code>object</code></td>
<td>
<p>a <code>MChromatograms</code> object.</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>for all methods: a <code>MChromatograms</code> object.</p>
</td></tr>
<tr valign="top"><td><code>i</code></td>
<td>
<p>for <code>[</code>: <code>numeric</code>, <code>logical</code> or <code>character</code>
defining which row(s) to extract.</p>
</td></tr>
<tr valign="top"><td><code>j</code></td>
<td>
<p>for <code>[</code>: <code>numeric</code>, <code>logical</code> or <code>character</code>
defining which columns(s) to extract.</p>
</td></tr>
<tr valign="top"><td><code>drop</code></td>
<td>
<p>for <code>[</code>: <code>logical(1)</code> whether to drop the dimensionality of the
returned object (if possible). The default is <code>drop = FALSE</code>, i.e. each
subsetting returns a <code>MChromatograms</code> object (or a <code>Chromatogram</code> object
if a single element is extracted).</p>
</td></tr>
<tr valign="top"><td><code>value</code></td>
<td>
<p>for <code style="white-space: pre;">[&lt;-</code>: the replacement object(s). Can be a <code>list</code>
of [Chromatogram()<code style="white-space: pre;">objects or, if length of</code>i<code>and</code>j<code style="white-space: pre;">are 1, a single</code>Chromatogram' object.</p>
<pre>For `pData&lt;-`: a `data.frame` with the number of rows matching
the number of columns of `object`.

For `colnames`: a `character` with the new column names.
</pre></td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
<p>for <code>plot</code>: the color to be used for plotting. Either a
vector of length 1 or equal to <code>ncol(x)</code>.</p>
</td></tr>
<tr valign="top"><td><code>lty</code></td>
<td>
<p>for <code>plot</code>: the line type (see <code>plot</code> in the <code>graphics</code> package
for more details). Can be either a vector of length 1 or of length equal
to <code>ncol(x)</code>.</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p>for <code>plot</code>: the type of plot (see <code>plot</code> from the <code>graphics</code>
package for more details). Can be either a vector of length 1 or of
length equal to <code>ncol(x)</code>.</p>
</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
<p>for <code>plot</code>: the x-axis label.</p>
</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
<p>for <code>plot</code>: the y-axis label.</p>
</td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
<p>for <code>plot</code>: the plot title. If not provided the mz range
will be used as plot title.</p>
</td></tr>
<tr valign="top"><td><code>name</code></td>
<td>
<p>for <code>$</code>, the name of the pheno data column.</p>
</td></tr>
<tr valign="top"><td><code>binSize</code></td>
<td>
<p>for <code>bin</code>: <code>numeric(1)</code> with the size of the bins
(in seconds).</p>
</td></tr>
<tr valign="top"><td><code>breaks</code></td>
<td>
<p>For <code>bin</code>: <code>numeric</code> defining the bins. Usually not
required as the function calculates the bins automatically based on
<code>binSize</code> and the retention time range of chromatograms in the same
row.</p>
</td></tr>
<tr valign="top"><td><code>fun</code></td>
<td>
<p>for <code>bin</code>: function to be used to aggregate the intensity
values falling within each bin.</p>
</td></tr>
<tr valign="top"><td><code>all</code></td>
<td>
<p>for <code>clean</code>: <code>logical(1)</code> whether all 0-intensities
should be removed (<code>all = TRUE</code>), or whether 0-intensities
adjacent to peaks should be kept (<code>all = FALSE</code>; default).</p>
</td></tr>
<tr valign="top"><td><code>na.rm</code></td>
<td>
<p>for <code>clean</code>: <code>logical(1)</code> whether all <code>NA</code>
intensities should be removed prior to clean 0-intensity data points.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p><code>character(1)</code>. For <code>normalise</code>: defining whether each
chromatogram should be normalized to its maximum signal
(<code>method = "max"</code>) or total signal (<code>method = "sum"</code>).
For <code>alignRt</code>: alignment methods (see documentation for <code>alignRt</code> in the
<code><a href="../../MSnbase/help/Chromatogram.html">Chromatogram()</a></code> help page. Defaults to <code>method = "closest"</code>.</p>
</td></tr>
<tr valign="top"><td><code>intensity</code></td>
<td>
<p>for <code>filterIntensity</code>: <code>numeric(1)</code> or <code>function</code> to use to
filter intensities. See description for details.</p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
<p>for <code>alignRt</code>: a <code><a href="../../MSnbase/help/Chromatogram.html">Chromatogram()</a></code> object against which <code>x</code> should be
aligned against.</p>
</td></tr>
<tr valign="top"><td><code>ALIGNFUN</code></td>
<td>
<p>for <code>compareChromatograms</code>: function to align chromatogram
<code>x</code> against chromatogram <code>y</code>. Defaults to <code>alignRt</code>.</p>
</td></tr>
<tr valign="top"><td><code>ALIGNFUNARGS</code></td>
<td>
<p><code>list</code> of parameters to be passed to <code>ALIGNFUN</code>.</p>
</td></tr>
<tr valign="top"><td><code>FUN</code></td>
<td>
<p>for <code>compareChromatograms</code>: function to calculate a similarity
score on the intensity values of the compared and aligned chromatograms.
Defaults to <code>FUN = cor</code>.</p>
</td></tr>
<tr valign="top"><td><code>FUNARGS</code></td>
<td>
<p>for <code>compareChromatograms</code>: <code>list</code> with additional parameters
for <code>FUN</code>. Defaults to <code>FUNARGS = list(use = "pairwise.complete.obs")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>MChromatograms</code> class extends the base <code>matrix</code> class
and hence allows to store <code><a href="../../MSnbase/help/Chromatogram.html">Chromatogram()</a></code> objects in a
two-dimensional array. Each row is supposed to contain
<code>Chromatogram</code> objects for one MS data <em>slice</em> with a common
m/z and rt range. Columns contain <code>Chromatogram</code> objects from the
same sample.
</p>


<h3>Value</h3>

<p>For <code>[</code>: the subset of the <code>MChromatograms</code> object. If a
single element is extracted (e.g. if <code>i</code> and <code>j</code> are of length
1) a <code><a href="../../MSnbase/help/Chromatogram.html">Chromatogram()</a></code> object is returned. Otherwise (if
<code>drop = FALSE</code>, the default, is specified) a <code>MChromatograms</code>
object is returned. If <code>drop = TRUE</code> is specified, the method
returns a <code>list</code> of <code>Chromatogram</code> objects.</p>
<pre>For `phenoData`: an `AnnotatedDataFrame` representing the
pheno data of the object.

For `pData`: a `data.frame` representing the pheno data of
the object.

For `$`: the value of the corresponding column in the pheno data
table of the object.

For all other methods see function description.
</pre>


<h3>Object creation</h3>

<p><code>MChromatograms</code> are returned by a <code><a href="../../MSnbase/help/chromatogram.html">chromatogram()</a></code> function from an <code>MSnExp</code>
or <code>OnDiskMSnExp</code>. Alternatively, the <code>MChromatograms</code> constructor function
can be used.
</p>


<h3>Data access</h3>


<ul>
<li> <p><code>$</code> and <code style="white-space: pre;">$&lt;-</code>: get or replace individual columns of the object's phenodata.
</p>
</li>
<li> <p><code>colnames</code> and <code style="white-space: pre;">colnames&lt;-</code>: replace or set the column names of the
<code>MChromatograms</code> object. Does also set the <code>rownames</code> of the <code>phenoData</code>.
</p>
</li>
<li> <p><code>fData</code>: return the feature data as a <code>data.frame</code>.
</p>
</li>
<li> <p><code style="white-space: pre;">fData&lt;-</code>: replace the object's feature data by passing a <code>data.frame</code>.
</p>
</li>
<li> <p><code>featureData</code>: return the feature data.
</p>
</li>
<li> <p><code style="white-space: pre;">featureData&lt;-</code>: replace the object's feature data.
</p>
</li>
<li> <p><code>featureNames</code>: returns the feature names of the <code>MChromatograms</code> object.
</p>
</li>
<li> <p><code style="white-space: pre;">featureNames&lt;-</code>: set the feature names.
</p>
</li>
<li> <p><code>fvarLabels</code>: return the feature data variable names (i.e. column names).
</p>
</li>
<li> <p><code>isEmpty</code>: returns <code>TRUE</code> if the <code>MChromatograms</code> object or all of its
<code>Chromatogram</code> objects is/are empty or contain only <code>NA</code> intensities.
</p>
</li>
<li> <p><code>mz</code>: returns the m/z for each row of the <code>MChromatograms</code> object
as a two-column <code>matrix</code> (with columns <code>"mzmin"</code> and <code>"mzmax"</code>).
</p>
</li>
<li> <p><code>pData</code>: accesses the phenotypical description of the samples. Returns a
<code>data.frame</code>.
</p>
</li>
<li> <p><code style="white-space: pre;">pData&lt;-</code>: replace the phenotype data.
</p>
</li>
<li> <p><code>phenoData</code>: accesses the phenotypical description of the samples. Returns
an <code>AnnotatedDataFrame</code> object.
</p>
</li>
<li> <p><code>polarity</code>: returns the polarity of the scans/chromatograms: <code>1</code>, <code>0</code> or
<code>-1</code> for positive, negative or unknown polarity.
</p>
</li>
<li> <p><code>precursorMz</code>: return the precursor m/z from the chromatograms. The
method returns a <code>matrix</code> with 2 columns (<code>"mzmin"</code> and <code>"mzmax"</code>) and as
many rows as there are rows in the <code>MChromatograms</code> object. Each row
contains the precursor m/z of the chromatograms in that row. An error is
thrown if the chromatograms within one row have different precursor m/z
values.
</p>
</li>
<li> <p><code>productMz</code>: return the product m/z from the chromatograms. The method
returns a <code>matrix</code> with 2 columns (<code>"mzmin"</code> and <code>"mzmax"</code>) and as many
rows as there are rows in the <code>MChromatograms</code> object. Each row contains
the product m/z of the chromatograms in that row. An error is thrown if
the chromatograms within one row have different product m/z values.
</p>
</li>
<li> <p><code style="white-space: pre;">rownames&lt;-</code>: replace the rownames (and featureNames) of the object.
</p>
</li></ul>



<h3>Data subsetting, combining and filtering</h3>


<ul>
<li> <p><code>[</code> subset (similar to a <code>matrix</code>) by row and column (with parameters <code>i</code>
and <code>j</code>).
</p>
</li>
<li> <p><code style="white-space: pre;">[&lt;-</code> replace individual or multiple elements. <code>value</code> has to be either a
single <code>Chromatogram</code> obhect or a <code>list</code> of <code>Chromatogram</code> objects.
</p>
</li>
<li> <p><code>c</code> concatenate (row-wise) <code>MChromatogram</code> objects with the
<strong>same number of samples (columns)</strong>.
</p>
</li>
<li> <p><code>filterIntensity</code>: filter each <code><a href="../../MSnbase/help/Chromatogram.html">Chromatogram()</a></code> object within the
<code>MChromatograms</code> removing data points with intensities below the user
provided threshold. If <code>intensity</code> is a <code>numeric</code> value, the returned
chromatogram will only contain data points with intensities &gt; <code>intensity</code>.
In addition it is possible to provide a function to perform the filtering.
This function is expected to take the input <code>Chromatogram</code> (<code>object</code>) and
to return a logical vector with the same length then there are data points
in <code>object</code> with <code>TRUE</code> for data points that should be kept and <code>FALSE</code>
for data points that should be removed. See the <code>filterIntensity</code>
documentation in the <code><a href="../../MSnbase/help/Chromatogram.html">Chromatogram()</a></code> help page for details and examples.
</p>
</li></ul>



<h3>Data processing and manipulation</h3>


<ul>
<li> <p><code>alignRt</code>: align all chromatograms in an <code>MChromatograms</code> object against
the chromatogram specified with <code>y</code>. See documentation on <code>alignRt</code> in the
<code><a href="../../MSnbase/help/Chromatogram.html">Chromatogram()</a></code> help page.
</p>
</li>
<li> <p><code>bin</code>: aggregates intensity values of chromatograms in discrete bins
along the retention time axis. By default, individual <code>Chromatogram</code>
objects of one row are binned into the same bins. The function returns a
<code>MChromatograms</code> object with binned chromatograms.
</p>
</li>
<li> <p><code>clean</code>: removes 0-intensity data points. Either all of them
(with <code>all = TRUE</code>) or all except those adjacent to non-zero
intensities (<code>all = FALSE</code>; default). See <code><a href="../../MSnbase/help/clean.html">clean()</a></code> documentation for more
details and examples.
</p>
</li>
<li> <p><code>compareChromatograms</code>: calculates pairwise similarity score between
chromatograms in <code>x</code> and <code>y</code>. If <code>y</code> is missing, a pairwise comparison
is performed between all chromatograms in <code>x</code>. See documentation on
<code>compareChromatograms</code> in the <code><a href="../../MSnbase/help/Chromatogram.html">Chromatogram()</a></code> help page for details.
</p>
</li>
<li> <p><code>normalize</code>, <code>normalise</code>: <em>normalises</em> the intensities of a chromatogram by
dividing them either by the maximum intensity (<code>method = "max"</code>) or total
intensity (<code>method = "sum"</code>) of the chromatogram.
</p>
</li></ul>



<h3>Data visualization</h3>


<ul>
<li> <p><code>plot</code>: plots a <code>MChromatograms</code> object. For each row in the object one
plot is created, i.e. all <code><a href="../../MSnbase/help/Chromatogram.html">Chromatogram()</a></code> objects in the same row are
added to the same plot. If <code>nrow(x) &gt; 1</code> the plot area is split into
<code>nrow(x)</code> sub-plots and the chromatograms of one row are plotted in
each.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Johannes Rainer
</p>


<h3>See Also</h3>

<p><code style="white-space: pre;">Chromatogram()] for the class representing chromatogram data. [chromatogram()] for the method to extract a </code>MChromatograms<code style="white-space: pre;">object from a</code>MSnExp<code>or</code>OnDiskMSnExp<code style="white-space: pre;"> object. [readSRMData()</code> for the function to read chromatographic data
of an SRM/MRM experiment.
</p>


<h3>Examples</h3>

<pre>
## Creating some chromatogram objects to put them into a MChromatograms object
ints &lt;- abs(rnorm(25, sd = 200))
ch1 &lt;- Chromatogram(rtime = 1:length(ints), ints)
ints &lt;- abs(rnorm(32, sd = 90))
ch2 &lt;- Chromatogram(rtime = 1:length(ints), ints)
ints &lt;- abs(rnorm(19, sd = 120))
ch3 &lt;- Chromatogram(rtime = 1:length(ints), ints)
ints &lt;- abs(rnorm(21, sd = 40))
ch4 &lt;- Chromatogram(rtime = 1:length(ints), ints)

## Create a MChromatograms object with 2 rows and 2 columns
chrs &lt;- MChromatograms(list(ch1, ch2, ch3, ch4), nrow = 2)
chrs

## Extract the first element from the second column. Extracting a single
## element always returns a Chromatogram object.
chrs[1, 2]

## Extract the second row. Extracting a row or column (i.e. multiple elements
## returns by default a list of Chromatogram objects.
chrs[2, ]

## Extract the second row with drop = FALSE, i.e. return a MChromatograms
## object.
chrs[2, , drop = FALSE]

## Replace the first element.
chrs[1, 1] &lt;- ch3
chrs

## Add a pheno data.
pd &lt;- data.frame(name = c("first sample", "second sample"),
    idx = 1:2)
pData(chrs) &lt;- pd

## Column names correspond to the row names of the pheno data
chrs

## Access a column within the pheno data
chrs$name

## Access the m/z ratio for each row; this will be NA for the present
## object
mz(chrs)


## Data visualization

## Create some random Chromatogram objects
ints &lt;- abs(rnorm(123, mean = 200, sd = 32))
ch1 &lt;- Chromatogram(rtime = seq_along(ints), intensity = ints, mz = 231)
ints &lt;- abs(rnorm(122, mean = 250, sd = 43))
ch2 &lt;- Chromatogram(rtime = seq_along(ints), intensity = ints, mz = 231)
ints &lt;- abs(rnorm(125, mean = 590, sd = 120))
ch3 &lt;- Chromatogram(rtime = seq_along(ints), intensity = ints, mz = 542)
ints &lt;- abs(rnorm(124, mean = 1200, sd = 509))
ch4 &lt;- Chromatogram(rtime = seq_along(ints), intensity = ints, mz = 542)

## Combine into a 2x2 MChromatograms object
chrs &lt;- MChromatograms(list(ch1, ch2, ch3, ch4), byrow = TRUE, ncol = 2)

## Plot the second row
plot(chrs[2, , drop = FALSE])

## Plot all chromatograms
plot(chrs, col = c("#ff000080", "#00ff0080"))
</pre>

<hr /><div style="text-align: center;">[Package <em>MSnbase</em> version 2.20.1 <a href="00Index.html">Index</a>]</div>
</div></body></html>
