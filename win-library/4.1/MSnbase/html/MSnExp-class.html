<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: The 'MSnExp' Class for MS Data And Meta-Data</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for MSnExp-class {MSnbase}"><tr><td>MSnExp-class {MSnbase}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>The 'MSnExp' Class for MS Data And Meta-Data</h2>

<h3>Description</h3>

<p>The <code>MSnExp</code> class encapsulates data and meta-data for mass
spectrometry experiments, as described in the <code>slots</code>
section. Several data files (currently in <code>mzXML</code>) can be loaded
together with the function <code><a href="../../MSnbase/help/readMSData.html">readMSData</a></code>.
</p>
<p>This class extends the virtual <code>"<a href="../../MSnbase/help/pSet-class.html">pSet</a>"</code> class.
</p>
<p>In version 1.19.12, the <code>polarity</code> slot had been added to the
<code>"<a href="../../MSnbase/help/Spectrum-class.html">Spectrum</a>"</code> class (previously in
<code>"<a href="../../MSnbase/help/Spectrum1-class.html">Spectrum1</a>"</code>). Hence, <code>"MSnExp"</code> objects
created prior to this change will not be valid anymore, since all MS2
spectra will be missing the <code>polarity</code> slot. Object can be
appropriately updated using the <code>updateObject</code> method.
</p>
<p>The feature variables in the feature data slot will depend on the
file. See also the documentation in the <code>mzR</code> package that parses
the raw data files and produces these data.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form
<code>new("MSnExp",...)</code>. However, it is preferred to use the
<code><a href="../../MSnbase/help/readMSData.html">readMSData</a></code> function that will read raw mass
spectrometry data to generate a valid <code>"MSnExp"</code> instance.
</p>


<h3>Slots</h3>


<dl>
<dt><code>assayData</code>:</dt><dd><p>Object of class <code>"environment"</code>
containing the MS spectra (see <code>"<a href="../../MSnbase/help/Spectrum1-class.html">Spectrum1</a>"</code>
and <code>"<a href="../../MSnbase/help/Spectrum2-class.html">Spectrum2</a>"</code>).
Slot is inherited from <code>"<a href="../../MSnbase/help/pSet-class.html">pSet</a>"</code>. </p>
</dd>
<dt><code>phenoData</code>:</dt><dd><p>Object of class
<code>"<a href="../../Biobase/html/class.AnnotatedDataFrame.html">AnnotatedDataFrame</a>"</code> containing
experimenter-supplied variables describing sample (i.e the
individual tags for an labelled MS experiment)
See <code><a href="../../Biobase/html/phenoData.html">phenoData</a></code> for more details.
Slot is inherited from <code>"<a href="../../MSnbase/help/pSet-class.html">pSet</a>"</code>. </p>
</dd>
<dt><code>featureData</code>:</dt><dd><p>Object of class
<code>"<a href="../../Biobase/html/class.AnnotatedDataFrame.html">AnnotatedDataFrame</a>"</code> containing variables
describing features (spectra in our case), e.g. identificaiton data,
peptide sequence, identification score,... (inherited from
<code>"<a href="../../Biobase/html/class.eSet.html">eSet</a>"</code>). See <code><a href="../../Biobase/html/featureData.html">featureData</a></code> for
more details.
Slot is inherited from <code>"<a href="../../MSnbase/help/pSet-class.html">pSet</a>"</code>. </p>
</dd>
<dt><code>experimentData</code>:</dt><dd><p>Object of class
<code>"<a href="../../MSnbase/help/MIAPE-class.html">MIAPE</a>"</code>, containing details of experimental
methods. See <code><a href="../../Biobase/html/abstract.html">experimentData</a></code> for more details.
Slot is inherited from <code>"<a href="../../MSnbase/help/pSet-class.html">pSet</a>"</code>. </p>
</dd>
<dt><code>protocolData</code>:</dt><dd><p>Object of class
<code>"<a href="../../Biobase/html/class.AnnotatedDataFrame.html">AnnotatedDataFrame</a>"</code> containing
equipment-generated variables (inherited from
<code>"<a href="../../Biobase/html/class.eSet.html">eSet</a>"</code>). See <code><a href="../../Biobase/html/protocolData.html">protocolData</a></code> for
more details.
Slot is inherited from <code>"<a href="../../MSnbase/help/pSet-class.html">pSet</a>"</code>. </p>
</dd>
<dt><code>processingData</code>:</dt><dd><p>Object of class
<code>"<a href="../../MSnbase/help/MSnProcess-class.html">MSnProcess</a>"</code> that records all processing.
Slot is inherited from <code>"<a href="../../MSnbase/help/pSet-class.html">pSet</a>"</code>. </p>
</dd>
<dt><code>.__classVersion__</code>:</dt><dd><p>Object of class
<code>"<a href="../../Biobase/html/class.Versions.html">Versions</a>"</code> describing the versions of R,
the Biobase package, <code>"<a href="../../MSnbase/help/pSet-class.html">pSet</a>"</code> and
<code>MSnExp</code> of the current instance.
Slot is inherited from <code>"<a href="../../MSnbase/help/pSet-class.html">pSet</a>"</code>.
Intended for developer use and debugging (inherited from
<code>"<a href="../../Biobase/html/class.eSet.html">eSet</a>"</code>). </p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="../../MSnbase/help/pSet-class.html">pSet</a>"</code>, directly.
Class <code>"<a href="../../Biobase/html/class.VersionedBiobase.html">VersionedBiobase</a>"</code>, by class &quot;pSet&quot;, distance 2.
Class <code>"<a href="../../Biobase/html/class.Versioned.html">Versioned</a>"</code>, by class &quot;pSet&quot;, distance 3.
</p>


<h3>Methods</h3>

<p>See the <code>"<a href="../../MSnbase/help/pSet-class.html">pSet</a>"</code> class for documentation on
accessors inherited from <code>pSet</code>, subsetting and general attribute
accession.
</p>

<dl>
<dt>bin</dt><dd><p><code>signature(object = "MSnExp")</code>: Bins spectra.
See <code><a href="../../MSnbase/help/bin.html">bin</a></code> documentation for more details and examples. </p>
</dd>
<dt>clean</dt><dd><p><code>signature(object = "MSnExp")</code>: Removes unused 0
intensity data points. See <code><a href="../../MSnbase/help/clean.html">clean</a></code> documentation
for more details and examples. </p>
</dd>
<dt>compareSpectra</dt><dd><p><code>signature(x = "Spectrum",
        y = "missing")</code>: Compares spectra.  See
<code><a href="../../MSnbase/help/compareSpectra.html">compareSpectra</a></code> documentation for more details and
examples. </p>
</dd>
<dt>extractPrecSpectra</dt><dd><p><code>signature(object = "MSnExp", prec =
        "numeric")</code>: extracts spectra with precursor MZ value equal to
<code>prec</code> and returns an object of class 'MSnExp'.
See <code><a href="../../MSnbase/help/extractPrecSpectra.html">extractPrecSpectra</a></code> documentation for more
details and examples. </p>
</dd>
</dl>





<dl>
<dt>pickPeaks</dt><dd><p><code>signature(object = "MSnExp")</code>: Performs the peak
picking to generate centroided spectra. Parameter <code>msLevel.</code>
allows to restrict peak picking to spectra of certain MS level(s).
See <code><a href="../../MSnbase/help/pickPeaks.html">pickPeaks</a></code> documentation for more
details and examples. </p>
</dd>
<dt>estimateNoise</dt><dd><p><code>signature(object = "MSnExp")</code>: Estimates
the noise in all profile spectra of <code>object</code>.  See
<code><a href="../../MSnbase/help/estimateNoise.html">estimateNoise</a></code> documentation for more details and
examples. </p>
</dd>
<dt>plot</dt><dd><p><code>signature(x = "MSnExp", y = "missing")</code>: Plots
the <code>MSnExp</code> instance. See <code><a href="../../MSnbase/help/plot.MSnExp.html">plot.MSnExp</a></code>
documentation for more details. </p>
</dd>
<dt>plot2d</dt><dd><p><code>signature(object = "MSnExp", ...)</code>:
Plots retention time against precursor MZ for <code>MSnExp</code>
instances. See <code><a href="../../MSnbase/help/plot2d.html">plot2d</a></code> documentation for more
details. </p>
</dd>
<dt>plotDensity</dt><dd><p><code>signature(object = "MSnExp", ...)</code>:
Plots the density of parameters of interest.
instances. See <code><a href="../../MSnbase/help/plotDensity.html">plotDensity</a></code> documentation for more
details. </p>
</dd>
<dt>plotMzDelta</dt><dd><p><code>signature(object = "MSnExp", ...)</code>:
Plots a histogram of the m/z difference betwee all of the highest
peaks of all MS2 spectra of an experiment.
See <code><a href="../../MSnbase/help/plotMzDelta.html">plotMzDelta</a></code> documentation for more details. </p>
</dd>
<dt>quantify</dt><dd><p><code>signature(object = "MSnExp")</code>: Performs
quantification for all the MS2 spectra of the <code>MSnExp</code>
instance. See <code><a href="../../MSnbase/help/quantify.html">quantify</a></code> documentation for more
details. Also for <code>OnDiskMSnExp</code> objects. </p>
</dd>
<dt>removePeaks</dt><dd><p><code>signature(object = "MSnExp")</code>: Removes
peaks lower that a threshold <code>t</code>. See
<code><a href="../../MSnbase/help/removePeaks.html">removePeaks</a></code> documentation for more details and
examples. </p>
</dd>
<dt>removeReporters</dt><dd><p><code>signature(object = "MSnExp", ...)</code>:
Removes reporter ion peaks from all MS2 spectra of an
experiment. See <code><a href="../../MSnbase/help/removeReporters.html">removeReporters</a></code> documentation for
more details and examples. </p>
</dd>
<dt>smooth</dt><dd><p><code>signature(x = "MSnExp")</code>: Smooths spectra.
See <code><a href="../../MSnbase/help/smooth.html">smooth</a></code> documentation for more details and examples. </p>
</dd>
<dt>addIdentificationData</dt><dd><p><code>signature(object = "MSnExp", ...)</code>:
Adds identification data to an experiment.
See <code><a href="../../MSnbase/help/addIdentificationData.html">addIdentificationData</a></code> documentation for
more details and examples. </p>
</dd>
<dt>removeNoId</dt><dd><p><code>signature(object = "MSnExp", fcol =
        "pepseq", keep = NULL)</code>: Removes non-identified features. See
<code><a href="../../MSnbase/help/removeNoId.html">removeNoId</a></code> documentation for more details and
examples. </p>
</dd>
<dt>removeMultipleAssignment</dt><dd><p><code>signature(object = "MSnExp",
        fcol = "nprot")</code>: Removes protein groups (or feature belong to
protein groups) with more than one member. The latter is defined
by extracting a feature variable (default is
<code>"nprot"</code>). Also removes non-identified features. </p>
</dd>
<dt>idSummary</dt><dd><p><code>signature(object = "MSnExp", ...)</code>:
Prints a summary that lists the percentage of identified features per
file (called <code>coverage</code>).</p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "MSnExp")</code>: Displays object
content as text. </p>
</dd>
<dt>isolationWindow</dt><dd><p><code>signature(object = "MSnExp", ...)</code>:
Returns the isolation window offsets for the MS2 spectra. See
<code><a href="../../mzR/html/isolationWindow-methods.html">isolationWindow</a></code> in the <code>mzR</code> package for details. </p>
</dd>
<dt>trimMz</dt><dd><p><code>signature(object = "MSnExp")</code>: Trims the MZ
range of all the spectra of the <code>MSnExp</code> instance. See
<code><a href="../../MSnbase/help/trimMz.html">trimMz</a></code> documentation for more details and
examples. </p>
</dd>
<dt><code>isCentroided(object, k = 0.025, qtl = 0.9, verbose =
        TRUE)</code></dt><dd><p> A heuristic assessing if the spectra in the
<code>object</code> are in profile or centroided mode. The function
takes the <code>qtl</code>th quantile top peaks, then calculates the
difference between adjacent M/Z value and returns <code>TRUE</code> if
the first quartile is greater than <code>k</code>. (See
<code>MSnbase:::.isCentroided</code> for the code.) If <code>verbose</code>
(default), a table indicating mode for all MS levels is printed.
</p>
<p>The function has been tuned to work for MS1 and MS2 spectra and
data centroided using different peak picking algorithms, but false
positives can occur. See
<a href="https://github.com/lgatto/MSnbase/issues/131">https://github.com/lgatto/MSnbase/issues/131</a> for
details. For whole experiments, where all MS1 and MS2 spectra are
expected to be in the same, albeit possibly different modes, it is
advised to assign the majority result for MS1 and MS2 spectra,
rather than results for individual spectra. See an example below.
</p>
</dd>
<dt>as</dt><dd><p><code>signature(object = "MSnExp", "data.frame")</code>:
Coerces the <code>MSnExp</code> object to a four-column
<code>data.frame</code> with columns <code>"file"</code> (file index in
<code>object</code>), <code>"rt"</code> (retention time), <code>"mz"</code> (m/z
values) and <code>"i"</code> (intensity values).
</p>
</dd>
<dt>as</dt><dd><p><code>signature(object = "MSnExp", "MSpectra")</code>:
Coerces the <code>MSnExp</code> object to a <code><a href="../../MSnbase/help/MSpectra-class.html">MSpectra</a></code>
object with all feature annotations added as metadata columns
(<code>mcols</code>).
</p>
</dd>
</dl>
<p>Clarifications regarding scan/acquisition numbers and indices:
</p>
<p>A <code>spectrumId</code> (or <code>spectrumID</code>) is a vendor specific
field in the mzML file that contains some information about the
run/spectrum, e.g.: <code>controllerType=0 controllerNumber=1
    scan=5281 file=2</code>.
</p>
<p><code>acquisitionNum</code> is a more a less sanitize spectrum id
generated from the <code>spectrumId</code> field by <code>mzR</code> (see
https://github.com/sneumann/mzR/blob/master/src/pwiz/data/msdata/MSData.cpp#L552-L580).
</p>
<p><code>scanIndex</code> is the <code>mzR</code> generated sequence number of the
spectrum in the raw file (which doesn't have to be the same as the
<code>acquisitionNum</code>).
</p>
<p>See also this issue: https://github.com/lgatto/MSnbase/issues/525.
</p>

<p>Filtering and subsetting functions:
</p>

<dl>
<dt>filterRt</dt><dd><p><code>signature(object = "MSnExp", rt = "numeric",
        msLevel. = "numeric")</code>: Retains MS spectra of level
<code>msLevel.</code> with a retention times within <code>rt[1]</code> and
<code>rt[2]</code>. </p>
</dd>
<dt>filterMsLevel</dt><dd><p><code>signature(object = "MSnExp", msLevel. =
        "numeric")</code>: Retains MS spectra of level <code>msLevel.</code>. </p>
</dd>
<dt>filterPolarity</dt><dd><p><code>signature(object = "MSnExp", polarity. =
        "numeric")</code>: Retains MS spectra of polarity <code>polarity.</code>. </p>
</dd>
<dt>filterMz</dt><dd><p><code>signature(object = "MSnExp", mz = "numeric",
        msLevel. = "numeric")</code>. See <code><a href="../../MSnbase/help/filterMz.html">filterMz</a></code> for
details. </p>
</dd>
<dt>filterFile</dt><dd><p><code>signature(object = "MSnExp", file)</code>: Retains
MS data of files matching the file index or file name provided
with parameter <code>file</code>.</p>
</dd>
<dt>filterAcquisitionNum</dt><dd></dd>
<dt>filterEmptySpectra</dt><dd><p><code>signature(object = "MSnExp")</code>:
Remove empty spectra from <code>object</code> (see <code>isEmpty</code>). </p>
</dd>
<dt>filterPrecursorScan</dt><dd><p><code>signature(object = "MSnExp",
        acquisitionNum = "numeric")</code>: Retain parent (e.g. MS1) and
children scans (e.g. MS2) of <code>acquisitionNum</code>. See
<code><a href="../../MSnbase/help/OnDiskMSnExp.html">OnDiskMSnExp</a></code> for an example. </p>
</dd>
<dt>splitByFile</dt><dd><p><code>signature(object = "MSnExp", f =
        "factor")</code>: split a <code>MSnExp</code> object by file into a
<code>list</code> of <code>MSnExp</code> objects given the grouping in
<code>factor</code> <code>f</code>.
</p>
</dd>
<dt>filterPrecursorMz</dt><dd><p><code>signature(object = "MSnExp", mz, ppm
	= 10)</code>: retain spectra with a precursor m/z equal or similar to
the one defined with parameter <code>mz</code>. Parameter <code>ppm</code>
allows to define an accepted difference between the provided m/z
and the spectrum's m/z.
</p>
</dd>
<dt>filterIsolationWindow</dt><dd><p><code>signature(object = "MSnExp",
	mz)</code>: retain spectra with isolation windows that contain
(which m/z range contain) the specified m/z.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Laurent Gatto &lt;lg390@cam.ac.uk&gt;
</p>


<h3>References</h3>

<p>Information about the mzXML format as well converters from vendor
specific formats to mzXML:
<a href="http://tools.proteomecenter.org/wiki/index.php?title=Formats:mzXML">http://tools.proteomecenter.org/wiki/index.php?title=Formats:mzXML</a>.
</p>


<h3>See Also</h3>

<p><code>"<a href="../../MSnbase/help/pSet-class.html">pSet</a>"</code> and <code><a href="../../MSnbase/help/readMSData.html">readMSData</a></code> for loading
<code>mzXML</code>, <code>mzData</code> or <code>mzML</code> files to generate an
instance of <code>MSnExp</code>.
</p>
<p>The  <code>"<a href="../../MSnbase/help/OnDiskMSnExp-class.html">OnDiskMSnExp</a>"</code> manual page contains further
details and examples.
</p>
<p><code><a href="../../MSnbase/help/chromatogram.html">chromatogram</a></code> to extract chromatographic data from a
<code>MSnExp</code> or <code>OnDiskMSnExp</code> object.
</p>
<p><code><a href="../../base/html/write.html">write</a></code> for the function to write the data to mzML or
mzXML file(s).
</p>


<h3>Examples</h3>

<pre>
mzxmlfile &lt;- dir(system.file("extdata",package="MSnbase"),
                 pattern="mzXML",full.names=TRUE)
msnexp &lt;- readMSData(mzxmlfile)
msnexp
</pre>

<hr /><div style="text-align: center;">[Package <em>MSnbase</em> version 2.20.1 <a href="00Index.html">Index</a>]</div>
</div></body></html>
